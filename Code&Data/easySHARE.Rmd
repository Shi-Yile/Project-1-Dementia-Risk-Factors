---
title: "Dementia Risk Factors: EDA of easySHARE data"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE)
Sys.setlocale("LC_ALL", "UK")
#setwd("~/Documents/GitHub/easySHARE/R")
```

## Load data

Load the easySHARE data. For information on data and variables, see the [easySHARE data  guide](http://www.share-project.org/fileadmin/pdf_documentation/easySHARE_Release_8.0.0_ReleaseGuide.pdf).

```{r easyshare}
load("easySHARE_rel8_0_0.rda")
```

Load packages:

```{r packs, include = FALSE}
library(ggplot2)
library(tidyverse)
library(gridExtra)
```

## Cognitive score

EasySHARE does not record diagnosis of dementia (e.g. Alzheimer's disease) in all waves. Instead, we will create a composite cognitive score as a proxy for dementia severity, following [Crimmins et al. (2011)](https://pubmed.ncbi.nlm.nih.gov/21743047/). The cognitive function indices are described in pg. 23 of the easySHARE data guide.

```{r cogindices, message = FALSE, fig.height=3, fig.width=9}
cogvars <- c("recall_1", "recall_2", "orienti", "numeracy_1", "numeracy_2")
cog = easySHARE_rel8_0_0[cogvars]
p1 = ggplot() +
  geom_histogram(aes(x=cog$recall_1), color="darkblue", fill="lightblue") +
  labs(x ="Recall of words, first trial")
p2 = ggplot() +
  geom_histogram(aes(x=cog$recall_2), color="darkblue", fill="lightblue") +
  labs(x ="Recall of words, second trial")
p3 = ggplot() +
  geom_histogram(aes(x=cog$orienti), color="darkblue", fill="lightblue") +
  labs(x ="Orientation to date")
p4 = ggplot() +
  geom_histogram(aes(x=cog$numeracy_1), color="darkblue", fill="lightblue") +
  labs(x ="Numeracy Score 1 (percentage)")
p5 = ggplot() +
  geom_histogram(aes(x=cog$numeracy_2), color="darkblue", fill="lightblue") +
  labs(x ="Numeracy Score 2 (subtraction)")
grid.arrange(p1, p2, p3, p4, p5, nrow = 2)
```

Notice the missing values (missing codes are explained on pg. 6 of missing codes of the easySHARE guide). In addition, for the numeracy measures, only one score is recorded in latter waves (pg. 23). Here we take a simple average if both measures are availble. However, you may consider other approaches (please include an explanation/motivation). Notice that  `numeracy_1` ranges from 1 to 5, while `numeracy_2` ranges from 0 to 5.

```{r numeracy, message = FALSE, warning=FALSE, fig.height=2, fig.width=3}
numeracy = rep(NA,dim(cog)[1])
numeracy[cog$numeracy_1 >= 0 & cog$numeracy_2 >= 0] = (cog$numeracy_1[cog$numeracy_1 >= 0 & cog$numeracy_2 >= 0] + cog$numeracy_2[cog$numeracy_1 >= 0 & cog$numeracy_2 >= 0] )/2
numeracy[cog$numeracy_1 >= 0 & cog$numeracy_2 < 0] = cog$numeracy_1[cog$numeracy_1 >= 0 & cog$numeracy_2 < 0]
numeracy[cog$numeracy_1 < 0 & cog$numeracy_2 >= 0] = cog$numeracy_2[cog$numeracy_1 < 0 & cog$numeracy_2 >= 0]
cog$numeracy = numeracy
ggplot() +
  geom_histogram(aes(x=cog$numeracy), color="darkblue", fill="lightblue") +
  labs(x ="Numeracy Score")
```

We now create a composite cognitive score, ranging from 0 (bad) to 29 (good), that combines the recall scores, orientation, and numeracy measure. Note that orientation is on the opposite scale, with 0 (good) and 4 (bad), so we transform appropriately. 

```{r cogscore, message = FALSE, warning=FALSE, fig.height=2, fig.width=3}
cogscore = rep(NA,dim(cog)[1])
ind = cog$recall_1 >= 0 & cog$recall_2 >= 0 & cog$orienti >= 0 & !is.na(numeracy)
cogscore[ind] = cog$recall_1[ind] + cog$recall_2[ind] + (4 - cog$orienti[ind]) + cog$numeracy[ind]
cog$cogscore = cogscore
ggplot() +
  geom_histogram(aes(x=cog$cogscore[ind]), color="darkblue", fill="lightblue", binwidth =2 ) +
  labs(x ="Composite cogntive score")
```

According to expertise knowledge, if we focus on the influence of risk factors on a single data point, the cognitive score based on four indices above is fine; but if we seek to explore the influence of risk factors over time, it would be better to create the cognitive score using `recall_1` and `recall_2` only as the other indices are inappropriate (`orient_date`) or contain too many missing values (`numeracy_1`, `numeracy_2`).


## Dementia risk factors

Extract variables related to modifiable risk factors identified in literature: education, hearing loss, traumatic brain injury, hypertension, alcohol consumption, smoking, obesity, physical activity, depression, social isolation, diabetes, and air pollution [Livingston et al. (2020)](https://www.thelancet.com/article/S0140-6736(20)30367-6/fulltext). Refer to the easySHARE guide for a description of the variables available. You may also consider other relevant risk factors, along with an explanation and motivation. Gender and age are also relevant variables to consider, e.g. to explore differences between men and women [Beam et al. (2018)](https://pubmed.ncbi.nlm.nih.gov/30010124/).

The SHARE project is a multi-country longitudinal study. You may decide to focus on a single or compare multiple countries. 


## Variables Selection

According to the work of [Livingston et al. (2020)](https://www.thelancet.com/article/S0140-6736(20)30367-6/fulltext) and [easySHARE data  guide](http://www.share-project.org/fileadmin/pdf_documentation/easySHARE_Release_8.0.0_ReleaseGuide.pdf), we select the following risk factors with specific variables in the easySHARE dataset.


```{r}
# subset of columns used to create risk factors
vars <- c("wave", "country", "mergeid",    # identifiers
          "age",    # age 
          "female",   # gender
          "isced1997_r",    # education
          "partnerinhh",    # social isolation 
          "chronic_mod",    # chronic disease
          # "hc002_mod", "hc012_", "hc029_",    # health care
          "eurod", # depression
          "br015_",    # physical activity
          "bmi2",    # obesity
          "smoking",   # smoking
          "br010_mod",    # alcohol 
          "ep005_",    # job situation
          "co007_",    # income
          "recall_1", "recall_2", "numeracy_2")  
```

```{r}
# extract specified columns from the original dataset
subset <- easySHARE_rel8_0_0[vars]
# specify wave 5
w5 <- subset[subset$wave == 5, ]

# the proportion of missing values in each column 
w5_num <- subset(w5, select = -mergeid)
mis_prop <- apply(w5_num, 2, function(x) length(x[x < 0]) / length(x))
sort(round(mis_prop, 4), decreasing = TRUE)
```

```{r}
# number and proportion of observations with missing values
idx_com_5 <- which(apply(w5_num, 1, function(x) all(x >= 0)) == TRUE)
cat("The number of complete observations in wave 5 is: ", length(idx_com_5), "\n")
cat("The proportion of complete observations in wave 5 is: ", 
    round(length(idx_com_5) / nrow(w5), 4))
```

```{r}
# data processing step
w5_ <- w5
# convert missing values to NA
w5_[which(w5_ < 0, arr.ind = TRUE)] = NA

w5_ <- w5_ %>% 
  # rename the columns using risk factors
  rename(id = mergeid,
         education = isced1997_r, 
         alcohol = br010_mod,
         obesity = bmi2,
         chronic = chronic_mod,
         work = ep005_,
         income = co007_,
         depression = eurod,
         physical = br015_,
         social = partnerinhh) %>% 
  # recode binary(1/5) variables to 0/1 (0 -> 5)
  mutate_at("smoking", 
            ~ if_else(.x == 5, 0, 1, missing = NULL)) %>%
  # create indicator for smoking status and cognitive score
  mutate(# smoking = smoking + ever_smoked,
         cogscore = recall_1 + recall_2 + numeracy_2) %>% 
  # keep risk factors and cognitive score, with country and id 
  dplyr::select(c(age, id, female, education, alcohol, obesity, chronic, work, 
                  income, depression, smoking, physical, social,
                  cogscore, country))


w5_work_97_id <- w5_$id[w5_$work == 97]
w5_edu_9597_id <- w5_$id[w5_$education > 90]
w5_wrong_id <- union(w5_work_97_id, w5_edu_9597_id)
w5_ <- w5_[w5_$id %in% w5_wrong_id == FALSE, ]
```


```{r}
# discretize age using cut() function
w5_$age <- cut(w5_$age, breaks = c(min(w5_$age, na.rm = T), 
                                   seq(50,90,5), max(w5_$age, na.rm = T)), 
                  ordered_result = TRUE, right = FALSE)
# discretize cognitive score based on 10%(severe) and 40%(mild) quantiles
w5_$cogscore <- cut(w5_$cogscore, 
                    breaks = c(0, quantile(w5_$cogscore, 
                                           probs = c(0.1, 0.4), na.rm = T), 
                               max(w5_$cogscore, na.rm = T)),
                    ordered_result = TRUE)
# factorize gender
w5_$female <- factor(w5_$female)
# factorize education and combine some levels
w5_$education[w5_$education == 4 | w5_$education == 5 | w5_$education == 6] = 4
w5_$education <- factor(w5_$education, ordered = TRUE)
# factorize alcohol and combine some levels
w5_$alcohol[w5_$alcohol == 2 | w5_$alcohol == 3] = 2
w5_$alcohol[w5_$alcohol == 4 | w5_$alcohol == 5] = 3
w5_$alcohol[w5_$alcohol == 6 | w5_$alcohol == 7] = 4
w5_$alcohol <- factor(w5_$alcohol, ordered = TRUE)
# factorize obesity 
w5_$obesity <- factor(w5_$obesity, ordered = TRUE)
# discretize chronic disease 
w5_$chronic <- cut(w5_$chronic, breaks = c(0, 1, 3, max(w5_$chronic)),
                       ordered_result = TRUE, right = FALSE)
# factorize work status
w5_$work <- factor(w5_$work, ordered = TRUE)
# factorize income
w5_$income <- factor(w5_$income, ordered = TRUE)
# discretize depression
w5_$depression <- cut(w5_$depression, breaks = c(0, 2, 5, 12),
                         ordered_result = TRUE, right = FALSE)
# factorize smoking status
w5_$smoking <- factor(w5_$smoking, ordered = TRUE)
# factorize physical activity frequency and combine some levels
w5_$physical[w5_$physical == 2 | w5_$physical == 3] = 2
w5_$physical[w5_$physical == 4] = 3
w5_$physical <- factor(w5_$physical, ordered = TRUE)
# factorize social status and combine some levels
w5_$social[w5_$social == 3] = 0
w5_$social <- factor(w5_$social, ordered = TRUE)
```

```{r}
sort(table(w5_$country), decreasing = TRUE)
country_high <- c(31, 20, 18, 13, 14, 11, 23, 12, 17)
w5_high <- w5_[w5_$country %in% country_high, ]
w5_low <- w5_[setdiff(row.names(w5_), row.names(w5_high)),]
```

```{r}
w5_12 <- w5_[w5_$country == 12, ]
head(w5_12)
```

```{r, include = FALSE}
library(bnlearn)
library(Rgraphviz)
```

```{r}
rf_score <- names(w5_)[!names(w5_) %in% c("id", "country")]
rf_score
```

```{r}
# no arrow from cognitive score
bl <- matrix(cbind("cogscore", rf_score[rf_score != "cogscore"]), 
             ncol = 2, dimnames = list(NULL, c("from", "to")))
# no arrow to gender
bl2 <- matrix(cbind(rf_score[rf_score != "female"], "female"), ncol = 2,
              dimnames = list(NULL, c("from", "to")))
bl <- unique(rbind(bl, bl2), MARGIN = 1)
# no arrow to age
bl2 <- matrix(cbind(rf_score[rf_score != "age"], "age"), ncol = 2,
              dimnames = list(NULL, c("from", "to")))
bl <- unique(rbind(bl, bl2), MARGIN = 1)
# no arrow to education except gender and age
bl2 <- matrix(cbind(rf_score[!rf_score %in% c("age", "female", "education")], 
                    "education"), ncol = 2,
              dimnames = list(NULL, c("from", "to")))
bl <- unique(rbind(bl, bl2), MARGIN = 1)
# no arrow from depression as it is in mental domain
bl2 <- matrix(cbind("depression", 
                    rf_score[!rf_score %in% c("depression", "cogscore")]),
              ncol = 2, dimnames = list(NULL, c("from", "to")))
bl <- unique(rbind(bl, bl2), MARGIN = 1)
# smoking status and drinking behaviour are not influenced by obesity, chronic diseases or physical activity frequency
bl <- rbind(bl, 
            matrix(c("obesity", "smoking",
                     "obesity", "alcohol", 
                     "chronic", "smoking",
                     "chronic", "alcohol",
                     "physical", "smoking",
                     "physical", "alcohol",
                     "income", "work"),
                   byrow = TRUE, ncol = 2, 
                   dimnames = list(NULL, c("from", "to"))))

```

```{r}
# create a white list
dag <- empty.graph(nodes = rf_score)
arc.set <- matrix(c("work", "income",
                    "social", "depression"),
                  byrow = TRUE, ncol = 2,
                  dimnames = list(NULL, c("from", "to")))
arcs(dag) <- arc.set
graphviz.plot(dag)
```


```{r, warning = FALSE}
# use observations in wave 5
w5_.iamb <- iamb(w5_[rf_score], 
                 blacklist = bl, whitelist = arc.set, test = "mi")
graphviz.plot(w5_.iamb)
```

```{r}
# test if age or gender has influence on smoking status
ci.test("smoking", "age", data = w5_[rf_score], test = "mi")
ci.test("smoking", "female", data = w5_[rf_score], test = "mi")
ci.test("smoking", "age", "female", data = w5_[rf_score], test = "mi")
ci.test("smoking", "female", "age", data = w5_[rf_score], test = "mi")
dag.w5.iamb <- set.arc(w5_.iamb, from = "age", to = "smoking")
dag.w5.iamb <- set.arc(dag.w5.iamb, from = "female", to = "smoking")
# score(dag.w5.iamb, data = drop_na(w5_[rf_score]), type = "bic")
# score(w5_.iamb, data = drop_na(w5_[rf_score]), type = "bic")

# test if alcohol has influence on chronic
ci.test("chronic", "alcohol", c("age", "obesity"), 
        data = w5_[rf_score], test = "mi")
dag.w5.iamb <- set.arc(dag.w5.iamb, from = "alcohol", to = "chronic")

# drop 
dag.w5.iamb <- drop.arc(dag.w5.iamb, from = "smoking", to = "income")

score(dag.w5.iamb, data = drop_na(w5_[rf_score]), type = "bic")
score(w5_.iamb, data = drop_na(w5_[rf_score]), type = "bic")
```

```{r}
w5_.hc <- hc(drop_na(w5_[rf_score]), 
             blacklist = bl, whitelist = arc.set, score = "aic")
graphviz.plot(w5_.hc)
```
```{r}

```


```{r}
# using complete data in high income country in wave 5
w5_high.iamb <- iamb(w5_high[rf_score], 
                   blacklist = bl, whitelist = arc.set, test = "mi")
graphviz.plot(w5_high.iamb)
```
```{r}

ci.test("work", "education", c("female", "age", "physical"), 
        data = w5_high[rf_score], test = "mi")
ci.test("obesity", "depression", c("chronic", "social", "income", "physical"),
        data = w5_high[rf_score], test = "mi")
ci.test("obesity", "chronic", data = w5_high[rf_score], test = "mi")
```

```{r}
# using complete data in low income country in wave 5
w5_low.iamb <- iamb(w5_low[rf_score], 
                   blacklist = bl, whitelist = arc.set, test = "mi")
graphviz.plot(w5_low.iamb)
```
```{r}
ci.test("smoking", "chronic", c("age", "obesity"),
        data = w5_low[rf_score], test = "mi")
ci.test("education", "age", data = w5_low[rf_score], test = "mi")
ci.test("education", "female", data = w5_low[rf_score], test = "mi")
ci.test("education", "age", "female", data = w5_low[rf_score], test = "mi")
ci.test("education", "female", "age", data = w5_low[rf_score], test = "mi")
```



```{r}
w5_12.iamb <- iamb(subset(w5_12, select = -c(id, country)), 
                   blacklist = bl, whitelist = arc.set, test = "mi")
graphviz.plot(w5_12.iamb)
```
```{r}
ci.test("cogscore", "physical", c("", "education"), 
        data = subset(w5_12, select = -c(id, country)), test = "mi")
```








































### Education

According to the easySHARE guide, the following columns are related to the education information of the patients:
\begin{itemize}
  \item \texttt{isced1997_r}: the ISCED-97 coding of education
  \item \texttt{eduyears_mod}: years of education
  \item \texttt{books_age10}: the number of books existed in the place the respondent lived at 10
  \item \texttt{maths_age10}: the performance in mathematics compared to other children when the respondent was 10
  \item \texttt{language_age10}: the relative language skills compared to other children when the respondent was 10
\end{itemize}

```{r edu}
eduvars <- c("isced1997_r", "eduyears_mod", "books_age10", 
             "maths_age10", "language_age10")
edu <- easySHARE_rel8_0_0[eduvars]
edu_miss <- data.frame(count = c(nrow(edu[edu$isced1997_r < 0, ]),
                                 nrow(edu[edu$eduyears_mod < 0, ]),
                                 nrow(edu[edu$books_age10 < 0, ]),
                                 nrow(edu[edu$maths_age10 < 0, ]),
                                 nrow(edu[edu$language_age10 < 0, ]),
                                 nrow(edu[apply(edu, 1, function(x) all(x < 0)) == T, ]),
                                 nrow(edu[apply(edu, 1, function(x) any(x < 0)) == T, ])),
                       row.names = c(eduvars, "union", "total"))
edu_miss
```

```{r edu}
p_edu_1 <- ggplot(edu, aes(x = as.factor(isced1997_r))) + 
  geom_bar(aes(y = (..count..)), color = "darkblue", fill = "lightblue") + 
  labs(x = "ISCED-97 Coding of Education")
p_edu_2 <- ggplot(edu, aes(x = as.factor(eduyears_mod))) + 
  geom_bar(aes(y = (..count..)), color = "darkblue", fill = "lightblue") + 
  labs(x = "Years of Education")
grid.arrange(p_edu_1, p_edu_2, nrow = 2)
p_edu_3 = ggplot() +
  geom_histogram(aes(x = edu$books_age10), color = "darkblue", 
                 fill = "lightblue", binwidth = 1) +
  labs(x = "Books read at 10")
p_edu_4 = ggplot() +
  geom_histogram(aes(x = edu$maths_age10), color = "darkblue", 
                 fill = "lightblue", binwidth = 1) +
  labs(x = "Maths performance at 10")
p_edu_5 = ggplot() +
  geom_histogram(aes(x = edu$language_age10), color = "darkblue", 
                 fill = "lightblue", binwidth = 1) +
  labs(x = "Language skills at 10")
grid.arrange(p_edu_3, p_edu_4, p_edu_5, nrow = 2)
```

```{r edu}
table(easySHARE_rel8_0_0$wave[edu$books_age10 >= 0])
table(easySHARE_rel8_0_0$wave[edu$maths_age10 >= 0])
table(easySHARE_rel8_0_0$wave[edu$language_age10 >= 0])
table(easySHARE_rel8_0_0$wave[edu$isced1997_r >= 0])
table(easySHARE_rel8_0_0$wave[edu$eduyears_mod >= 0])

```

```{r}
wave7 <- easySHARE_rel8_0_0[easySHARE_rel8_0_0$wave == 7, ]
head(easySHARE_rel8_0_0[easySHARE_rel8_0_0$country == 15, ])
```


### Hearing Loss

### TBI (Traumatic Brain Injury)

### Hypertension
### Diabetes

The `chronic_mod` measures the number of chronic diseases of a respondent. The following conditions are considered:
\begin{itemize}
  \item A heart attack 
  \item High blood pressure or hypertension
  \item High blood cholesterol
  \item A stroke or cerebral vascular disease
  \item Diabetes or high blood sugar
  \item Chronic lung disease
  \item Cancer or malignant tumor
  \item Stomach or duodenal ulcer, peptic ulcer
  \item Parkinson disease
  \item Cataracts
  \item Hip fracture or femoral fracture
\end{itemize}

Both \emph{hypertension} and \emph{diabetes} are included, while there is no single variable indicating each disease respectively.

```{r Hyper_Diab}
ggplot() +
  geom_histogram(aes(x = easySHARE_rel8_0_0$chronic_mod), color = "darkblue", 
                 fill = "lightblue", binwidth = 1) +
  labs(x = "Number of chronic diseases")
```


### Alcohol Consumption

\begin{itemize}
  \item \texttt{br010_mod}: information on respondent's drinking behaviour 
\end{itemize}

```{r Alcohol}
ggplot() +
  geom_histogram(aes(x = easySHARE_rel8_0_0$br010_mod), color = "darkblue", 
                 fill = "lightblue", binwidth = 1) +
  labs(x = "Drinking behaviour")
```


### Smoking

\begin{itemize}
  \item \texttt{smoking}: whether the respondent smokes at present
  \item \texttt{ever_smoked}: whether the respondent ever smoked daily
\end{itemize}

```{r Smoking}
smokevars <- c("smoking", "ever_smoked")
smoke <- easySHARE_rel8_0_0[smokevars]
smoke_miss <- data.frame(count = c(nrow(smoke[smoke$smoking < 0, ]),
                                   nrow(smoke[smoke$ever_smoked < 0, ]),
                                   nrow(smoke[apply(smoke, 1, function(x) all(x < 0)) == T, ]),
                                   nrow(smoke[apply(smoke, 1, function(x) any(x < 0)) == T, ])),
                         row.names = c(smokevars, "union", "total"))
smoke_miss
```

```{r Smoking}
p_smoke_1 = ggplot() +
  geom_histogram(aes(x = smoke$smoking), color = "darkblue", 
                 fill = "lightblue", binwidth = 1) +
  labs(x = "Present smoking status")
p_smoke_2 = ggplot() +
  geom_histogram(aes(x = smoke$ever_smoked), color = "darkblue", 
                 fill = "lightblue", binwidth = 1) +
  labs(x = "Past smoking status")
grid.arrange(p_smoke_1, p_smoke_2, nrow = 1)
```


### Obesity

\begin{itemize}
  \item \texttt{bmi}: the respondent's body mass index
  \item \texttt{bmi2}: categorized body mass index
\end{itemize}

```{r Obesity}
obesityvars <- c("bmi", "bmi2")
obesity <- easySHARE_rel8_0_0[obesityvars]
obesity_miss <- data.frame(count = c(nrow(obesity[obesity$bmi < 0, ]),
                                     nrow(obesity[obesity$bmi2 < 0, ]),
                                     nrow(obesity[apply(obesity, 1, function(x) all(x < 0)) == T, ]),
                                     nrow(obesity[apply(obesity, 1, function(x) any(x < 0)) == T, ])),
                           row.names = c(obesityvars, "union", "total"))
obesity_miss
```

```{r obesity}
p_obesity_1 = ggplot() +
  geom_histogram(aes(x = obesity$bmi), color = "darkblue", 
                 fill = "lightblue", binwidth = 3) +
  labs(x = "BMI")
p_obesity_2 = ggplot() +
  geom_histogram(aes(x = obesity$bmi2), color = "darkblue", 
                 fill = "lightblue", binwidth = 1) +
  labs(x = "Categorized BMI")
grid.arrange(p_obesity_1, p_obesity_2, nrow = 1)
```

### Physical Activity

\begin{itemize}
  \item \texttt{br015_}: information on the frequency of doing vigorous activities
  \item \texttt{maxgrip}: the maximum of grip strength measure
  \item \texttt{adla}: activities of daily living indices
  \item \texttt{iadlza}: instrumental activities of daily living indices 
  \item \texttt{mobilityind}: mobility index
  \item \texttt{lgmuscle}: large muscle index 
  \item \texttt{grossmotor}: gross motor skill index
  \item \texttt{finemotor}: fine motor skill index
\end{itemize}

```{r Physical}
phyvars <- c("br015_", "maxgrip", "adla", )
phy <- easySHARE_rel8_0_0[phyvars]
phy_miss <- data.frame(count = c(nrow(phy[phy$br015_ < 0, ]),
                                 nrow(phy[phy$maxgrip < 0, ]),
                                 nrow(phy[phy$adla < 0, ]),
                                 nrow(phy[phy$iadlza < 0, ]),
                                 nrow(phy[phy$mobilityind < 0, ]),
                                 nrow(phy[phy$lgmuscle < 0, ]),
                                 nrow(phy[phy$grossmotor < 0, ]),
                                 nrow(phy[phy$finemotor < 0, ]),
                                 nrow(phy[apply(phy, 1, function(x) all(x < 0)) == T, ]),
                                 nrow(phy[apply(phy, 1, function(x) any(x < 0)) == T, ])),
                       row.names = c(phyvars, "union", "total"))
phy_miss
```

```{r Physical}
p_phy_1 <- ggplot() +
  geom_histogram(aes(x = phy$br015_), color = "darkblue", 
                 fill = "lightblue", binwidth = 1) +
  labs(x = "Exercise frequency")
grid.arrange(p_phy_1)
```



### Depression

\begin{itemize}
  \item \texttt{casp}: the CASP-12 score that measures the quality of life
  \item \texttt{eurod}: a composite index that measures the current depression
\end{itemize}

### Social Isolation

Most columns in this part are not included in wave 3. 

We consider the following variables:
\begin{itemize}
  \item \texttt{mar_stat}: the respondent's marital status
  \item \texttt{hhsize}: number of people living in the respondent's household
  \item \texttt{partnerinhh}: whether the respondent is living with a spouse/partner in household
  \item \texttt{int_partner}: whether an interview of respondent's partner is available
  \item \texttt{age_partner}: the age of a respondent's partner 
  \item \texttt{gender_partner}: the gender of a respondent's partner
  \item \texttt{mother_alive}: whether the respondent's mother is still alive
  \item \texttt{father_alive}: whether the respondent's father is still alive
  \item \texttt{siblings_alive}: number of siblings alive
  \item \texttt{ch001_}: number of children
  \item \texttt{ch021_mod}: number of grandchildren
  \item \texttt{ch007_hh}: whether at least one child is in the same household
  \item \texttt{ch007_km}: whether at least one child lives less than 1km away from the respondent's household
  \item \texttt{sp002_mod}: whether the respondents (or if applicable their partners) have received help outside the household
  \item \texttt{sp008_}: whether the respondent has personally given help to anyone outside the household
\end{itemize}

Note that according to the guide, `sp003_1_mod` - `sp003_3_mod` indicate the persons outside the respondents' (or their partners') household who give help and `sp009_1_mod` - `sp009_3_mod` suggest the persons outside the household who receive help from the respondents. Here, these variables are numeric and we have the doubt whether we should take them into account and if so how we deal with them.    

```{r Social}
socialvars <- c("mar_stat", "hhsize", "partnerinhh", "int_partner", 
                "age_partner", "gender_partner", "mother_alive", "father_alive",
                "siblings_alive", "ch001_", "ch021_mod", "ch007_hh", "ch007_km",
                "sp002_mod", "sp008_")
```

### Air Pollution
