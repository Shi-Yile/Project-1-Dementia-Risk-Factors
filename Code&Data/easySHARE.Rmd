---
title: "Dementia Risk Factors: EDA of easySHARE data"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE)
Sys.setlocale("LC_ALL", "UK")
#setwd("~/Documents/GitHub/easySHARE/R")
```

## Load data

Load the easySHARE data. For information on data and variables, see the [easySHARE data  guide](http://www.share-project.org/fileadmin/pdf_documentation/easySHARE_Release_8.0.0_ReleaseGuide.pdf).

```{r easyshare}
load("easySHARE_rel8_0_0.rda")
```

Load packages:

```{r packs, include = FALSE}
library(ggplot2)
library(tidyverse)
library(gridExtra)
library(bnlearn)
library(Rgraphviz)
library(MASS)
```

## Cognitive score

EasySHARE does not record diagnosis of dementia (e.g. Alzheimer's disease) in all waves. Instead, we will create a composite cognitive score as a proxy for dementia severity, following [Crimmins et al. (2011)](https://pubmed.ncbi.nlm.nih.gov/21743047/). The cognitive function indices are described in pg. 23 of the easySHARE data guide.

```{r cogindices, message = FALSE, fig.height=3, fig.width=9}
cogvars <- c("recall_1", "recall_2", "orienti", "numeracy_1", "numeracy_2")
cog = easySHARE_rel8_0_0[cogvars]
p1 = ggplot() +
  geom_histogram(aes(x=cog$recall_1), color="darkblue", fill="lightblue") +
  labs(x ="Recall of words, first trial")
p2 = ggplot() +
  geom_histogram(aes(x=cog$recall_2), color="darkblue", fill="lightblue") +
  labs(x ="Recall of words, second trial")
p3 = ggplot() +
  geom_histogram(aes(x=cog$orienti), color="darkblue", fill="lightblue") +
  labs(x ="Orientation to date")
p4 = ggplot() +
  geom_histogram(aes(x=cog$numeracy_1), color="darkblue", fill="lightblue") +
  labs(x ="Numeracy Score 1 (percentage)")
p5 = ggplot() +
  geom_histogram(aes(x=cog$numeracy_2), color="darkblue", fill="lightblue") +
  labs(x ="Numeracy Score 2 (subtraction)")
grid.arrange(p1, p2, p3, p4, p5, nrow = 2)
```

Notice the missing values (missing codes are explained on pg. 6 of missing codes of the easySHARE guide). In addition, for the numeracy measures, only one score is recorded in latter waves (pg. 23). Here we take a simple average if both measures are availble. However, you may consider other approaches (please include an explanation/motivation). Notice that  `numeracy_1` ranges from 1 to 5, while `numeracy_2` ranges from 0 to 5.

```{r numeracy, message = FALSE, warning=FALSE, fig.height=2, fig.width=3}
numeracy = rep(NA,dim(cog)[1])
numeracy[cog$numeracy_1 >= 0 & cog$numeracy_2 >= 0] = (cog$numeracy_1[cog$numeracy_1 >= 0 & cog$numeracy_2 >= 0] + cog$numeracy_2[cog$numeracy_1 >= 0 & cog$numeracy_2 >= 0] )/2
numeracy[cog$numeracy_1 >= 0 & cog$numeracy_2 < 0] = cog$numeracy_1[cog$numeracy_1 >= 0 & cog$numeracy_2 < 0]
numeracy[cog$numeracy_1 < 0 & cog$numeracy_2 >= 0] = cog$numeracy_2[cog$numeracy_1 < 0 & cog$numeracy_2 >= 0]
cog$numeracy = numeracy
ggplot() +
  geom_histogram(aes(x=cog$numeracy), color="darkblue", fill="lightblue") +
  labs(x ="Numeracy Score")
```

We now create a composite cognitive score, ranging from 0 (bad) to 29 (good), that combines the recall scores, orientation, and numeracy measure. Note that orientation is on the opposite scale, with 0 (good) and 4 (bad), so we transform appropriately. 

```{r cogscore, message = FALSE, warning=FALSE, fig.height=2, fig.width=3}
cogscore = rep(NA,dim(cog)[1])
ind = cog$recall_1 >= 0 & cog$recall_2 >= 0 & cog$orienti >= 0 & !is.na(numeracy)
cogscore[ind] = cog$recall_1[ind] + cog$recall_2[ind] + (4 - cog$orienti[ind]) + cog$numeracy[ind]
cog$cogscore = cogscore
ggplot() +
  geom_histogram(aes(x=cog$cogscore[ind]), color="darkblue", fill="lightblue", binwidth =2 ) +
  labs(x ="Composite cogntive score")
```

According to expertise knowledge, if we focus on the influence of risk factors on a single data point, the cognitive score based on four indices above is fine; but if we seek to explore the influence of risk factors over time, it would be better to create the cognitive score using `recall_1` and `recall_2` only as the other indices are inappropriate (`orient_date`) or contain too many missing values (`numeracy_1`, `numeracy_2`).


## Dementia risk factors

Extract variables related to modifiable risk factors identified in literature: education, hearing loss, traumatic brain injury, hypertension, alcohol consumption, smoking, obesity, physical activity, depression, social isolation, diabetes, and air pollution [Livingston et al. (2020)](https://www.thelancet.com/article/S0140-6736(20)30367-6/fulltext). Refer to the easySHARE guide for a description of the variables available. You may also consider other relevant risk factors, along with an explanation and motivation. Gender and age are also relevant variables to consider, e.g. to explore differences between men and women [Beam et al. (2018)](https://pubmed.ncbi.nlm.nih.gov/30010124/).

The SHARE project is a multi-country longitudinal study. You may decide to focus on a single or compare multiple countries. 


## Variables Selection

According to the work of [Livingston et al. (2020)](https://www.thelancet.com/article/S0140-6736(20)30367-6/fulltext) and [easySHARE data  guide](http://www.share-project.org/fileadmin/pdf_documentation/easySHARE_Release_8.0.0_ReleaseGuide.pdf), we select the following risk factors with specific variables in the easySHARE dataset.


```{r}
# subset of columns used to create risk factors
vars <- c("wave", "country", "mergeid",    # identifiers
          "age",    # age 
          "female",   # gender
          "isced1997_r",    # education
          "partnerinhh",    # social isolation 
          "chronic_mod",    # chronic disease
          # "hc002_mod", "hc012_", "hc029_",    # health care
          "eurod", # depression
          "br015_",    # physical activity
          "bmi2",    # obesity
          "smoking",   # smoking
          "br010_mod",    # drinking behaviour 
          "ep005_",    # job situation
          "co007_",    # family economy status
          "recall_1", "recall_2", "numeracy_2")  
```

```{r}
# extract specified columns from the original dataset
subset <- easySHARE_rel8_0_0[vars]
# before any processing steps, we convert missing values to NA
subset[which(subset < 0, arr.ind = TRUE)] = NA
# specify on wave 5
w5 <- subset[subset$wave == 5, ]
```

```{r}
# the proportion of missing values in each column 
mis_prop <- apply(subset(w5, select = -mergeid), 
                  2, function(x) length(x[is.na(x)]) / length(x))
cat("The proportion of missing values in each column: \n")
sort(round(mis_prop, 4), decreasing = TRUE)
```

```{r}
# number and proportion of observations with missing values
idx_com_5 <- which(apply(subset(w5, select = -mergeid), 
                         1, function(x) any(is.na(x))) == FALSE)
cat("The number of complete observations in wave 5 is: ", length(idx_com_5), "\n")
cat("The proportion of complete observations in wave 5 is: ", 
    round(length(idx_com_5) / nrow(w5), 4))
```

```{r}
# data processing step
w5_ <- w5 %>% 
  # rename the columns using risk factors
  rename(id = mergeid,
         education = isced1997_r, 
         drinking = br010_mod,
         obesity = bmi2,
         chronic = chronic_mod,
         work = ep005_,
         economy = co007_,
         depression = eurod,
         phyactivity = br015_,
         social = partnerinhh) %>% 
  # recode binary(1/5) variables to 0/1 (0 -> 5)
  mutate_at("smoking", 
            ~ if_else(.x == 5, 0, 1, missing = NULL)) %>%
  # create indicator for smoking status and cognitive score
  mutate(# smoking = smoking + ever_smoked,
         cogscore = recall_1 + recall_2 + numeracy_2) %>% 
  # drop observations with missing values
  drop_na() %>%
  # filter individuals at least 50 in wave 5
  filter(age >= 50) %>%
  # keep risk factors and cognitive score, with country and id 
  dplyr::select(c(age, id, female, education, drinking, obesity, chronic, 
                  work, economy, depression, smoking, phyactivity, 
                  social, cogscore, country))
```

```{r}
# mergeid of patients with unclear education status
w5_edu_9597_id <- w5_$id[which(w5_$education > 90)]
cat(length(w5_edu_9597_id), round(length(w5_edu_9597_id) / nrow(w5_), 4))
```

```{r}
# extract the education and work status columns of these patients 
# as well as their mergeid and the wave of the observations
subset_ <- subset %>%
  filter(mergeid %in% w5_edu_9597_id) %>%
  dplyr::select(c(mergeid, wave, isced1997_r)) %>%
  rename(id = mergeid, edu = isced1997_r)
# count of each category
table(subset_$edu)
```
```{r}
# mergeid of patients with unclear working status
w5_work_97_id <- w5_$id[which(w5_$work > 90)]
cat(length(w5_work_97_id), round(length(w5_work_97_id) / nrow(w5_), 4))
```

```{r}
# drop rows of these patients whose education or working status is unclear 
w5_drop_id <- union(w5_edu_9597_id, w5_work_97_id)
w5_ <- w5_ %>% filter(!id %in% w5_drop_id)
```

```{r}
# discretize age using cut() function
w5_$age <- cut(w5_$age, breaks = c(seq(50,85,5), max(w5_$age)+1), 
                  ordered_result = TRUE, right = FALSE)
# discretize cognitive score based on 10%(severe) and 40%(mild) quantiles
w5_$cogscore <- cut(w5_$cogscore, 
                    breaks = c(0, quantile(w5_$cogscore, probs = c(0.1, 0.4)), 
                               max(w5_$cogscore)+1),
                    ordered_result = TRUE, right = FALSE)
# factorize gender
w5_$female <- factor(w5_$female)
# factorize education and combine some levels
w5_$education[w5_$education == 4 | w5_$education == 5 | w5_$education == 6] = 4
w5_$education <- factor(w5_$education, ordered = TRUE)
# factorize drinking and combine some levels
w5_$drinking[w5_$drinking == 2 | w5_$drinking == 3] = 2
w5_$drinking[w5_$drinking == 4 | w5_$drinking == 5] = 3
w5_$drinking[w5_$drinking == 6 | w5_$drinking == 7] = 4
w5_$drinking <- factor(w5_$drinking, ordered = TRUE)
# factorize obesity 
w5_$obesity <- factor(w5_$obesity, ordered = TRUE)
# discretize chronic disease 
w5_$chronic <- cut(w5_$chronic, breaks = c(0, 1, 3, max(w5_$chronic)+1),
                   ordered_result = TRUE, right = FALSE)
# factorize work status
w5_$work <- factor(w5_$work, ordered = TRUE)
# factorize economy
w5_$economy <- factor(w5_$economy, ordered = TRUE)
# discretize depression
w5_$depression <- cut(w5_$depression, breaks = c(0, 2, 5, 13),
                         ordered_result = TRUE, right = FALSE)
# factorize smoking status
w5_$smoking <- factor(w5_$smoking, ordered = TRUE)
# factorize phyactivity activity frequency and combine some levels
w5_$phyactivity[w5_$phyactivity == 2 | w5_$phyactivity == 3] = 2
w5_$phyactivity[w5_$phyactivity == 4] = 3
w5_$phyactivity <- factor(w5_$phyactivity, ordered = TRUE)
# factorize social status and combine some levels
w5_$social[w5_$social == 3] = 0
w5_$social <- factor(w5_$social, ordered = TRUE)
```

```{r}
# the number of observations in each country 
sort(table(w5_$country), decreasing = TRUE)
# countries with high per capita GDP
country_high <- c(31, 20, 18, 13, 14, 11, 23, 12, 17)
# categorize and factorize country 
w5_$country <- ifelse(w5_$country %in% country_high, 1, 0)
w5_$country <- factor(w5_$country, ordered = TRUE)
```


```{r}
# create a list of risk factors with the cognitive score
rf_score <- names(w5_)[names(w5_) != "id"]
rf_score
```

```{r}
# no arrow from cognitive score
bl <- matrix(cbind("cogscore", rf_score[rf_score != "cogscore"]), 
             ncol = 2, dimnames = list(NULL, c("from", "to")))
# no arrow to gender
bl2 <- matrix(cbind(rf_score[rf_score != "female"], "female"), ncol = 2,
              dimnames = list(NULL, c("from", "to")))
bl <- unique(rbind(bl, bl2), MARGIN = 1)
# no arrow to age
bl2 <- matrix(cbind(rf_score[rf_score != "age"], "age"), ncol = 2,
              dimnames = list(NULL, c("from", "to")))
bl <- unique(rbind(bl, bl2), MARGIN = 1)
# no arrow to country
bl2 <- matrix(cbind(rf_score[rf_score != "country"], "country"), ncol = 2,
              dimnames = list(NULL, c("from", "to")))
bl <- unique(rbind(bl, bl2), MARGIN = 1)
# no arrow to education except gender, age and country
bl2 <- matrix(cbind(rf_score[!rf_score %in% c("age", "female", "country")], 
                    "education"), ncol = 2,
              dimnames = list(NULL, c("from", "to")))
bl <- unique(rbind(bl, bl2), MARGIN = 1)

# smoking status and drinking behaviour are not influenced by obesity, chronic diseases or phyactivity activity frequency
bl <- rbind(bl, matrix(c("obesity", "smoking",
                         "obesity", "drinking", 
                         "chronic", "smoking",
                         "chronic", "drinking",
                         "phyactivity", "smoking",
                         "phyactivity", "drinking",
                         "economy", "work"),
                       byrow = TRUE, ncol = 2, 
                       dimnames = list(NULL, c("from", "to"))))
```

```{r}
# create a white list
dag <- empty.graph(nodes = rf_score)
# work status has influence on household economy status
# social status has influence on depression level
arc.set <- matrix(c("work", "economy",
                    "social", "depression"),
                  byrow = TRUE, ncol = 2,
                  dimnames = list(NULL, c("from", "to")))
arcs(dag) <- arc.set
graphviz.plot(dag)
```

```{r}
# define a function to calculate the average loss of cv
avg_loss <- function(bn_cv){
  n <- length(bn_cv)
  sum_loss <- 0
  for (i in 1:n){
    sum_loss <- sum_loss + bn_cv[[i]]$loss
  }
  sum_loss / n
}
```


```{r, warning = FALSE}
# define the list of algorithm candidates 
algorithm_list <- c("pc.stable", "gs", "iamb", "fast.iamb", "hc", "tabu")
# initialize the vector for the average loss of each algorithm
loss <- NULL

# loop to calculate the average loss of each algorithm
for (i in 1:length(algorithm_list)){
  # to compare, set the random seed
  set.seed(1)
  # cross validation with same settings
  bn_cv <- bn.cv(data = w5_[rf_score], bn = algorithm_list[i],
                 algorithm.args = list(blacklist = bl, whitelist = arc.set,
                                       test = "mi", undirected = FALSE),
                 loss = "pred", loss.args = list(target = "cogscore"))
  loss[i] <- avg_loss(bn_cv)
}
# name the vector with corresponding algorithms and sort it
names(loss) <- algorithm_list
sort(loss, decreasing = FALSE)
```

```{r}
# hill climbing algorithm
w5_.hc <- hc(w5_[rf_score], blacklist = bl, whitelist = arc.set)
graphviz.plot((w5_.hc))  
```
```{r}
# DAG modification
w5_.hc.mod <- w5_.hc
# modify some unreasonable arrows 
w5_.hc.mod <- drop.arc(w5_.hc.mod, from = "economy", to = "smoking")
w5_.hc.mod <- drop.arc(w5_.hc.mod, from = "depression", to = "phyactivity")
w5_.hc.mod <- drop.arc(w5_.hc.mod, from = "education", to = "drinking")
w5_.hc.mod <- reverse.arc(w5_.hc.mod, from = "chronic", to = "depression")

# add some arrows to make the network more reasonable
w5_.hc.mod <- set.arc(w5_.hc.mod, from = "female", to = "cogscore") 
w5_.hc.mod <- set.arc(w5_.hc.mod, from = "depression", to = "cogscore")
w5_.hc.mod <- set.arc(w5_.hc.mod, from = "phyactivity", to = "obesity")
w5_.hc.mod <- set.arc(w5_.hc.mod, from = "drinking", to = "obesity")
# ci.test("obesity", "cogscore", 
#         c("age", "female", "country", "education", "depression"), 
#         data = w5_[rf_score], test = "mi")
w5_.hc.mod <- set.arc(w5_.hc.mod, from = "obesity", to = "depression")
```

```{r}
# display the modified network 
graphviz.plot(w5_.hc.mod)
```


```{r, warning = FALSE}
# iamb algorithm
w5_.iamb <- iamb(w5_[rf_score], blacklist = bl, whitelist = arc.set, 
                 test = "mi", undirected = FALSE)
graphviz.plot(w5_.iamb)
```

```{r}
# DAG modification
w5_.iamb.mod <- w5_.iamb
# modify some unreasonable arrows
w5_.iamb.mod <- drop.arc(w5_.iamb.mod, from = "drinking", to = "economy")
w5_.iamb.mod <- drop.arc(w5_.iamb.mod, from = "phyactivity", to = "depression")
w5_.iamb.mod <- drop.arc(w5_.iamb.mod, from = "chronic", to = "depression")
w5_.iamb.mod <- drop.arc(w5_.iamb.mod, from = "education", to = "drinking")
w5_.iamb.mod <- reverse.arc(w5_.iamb.mod, from = "chronic", to = "obesity")
w5_.iamb.mod <- reverse.arc(w5_.iamb.mod, from = "phyactivity", to = "chronic")

# test if country has direct effect on cognitive score
ci.test("country", "cogscore", 
        c("age", "female", "education", "phyactivity", "depression"),
        data = w5_[rf_score], test = "mi")
w5_.iamb.mod <- set.arc(w5_.iamb.mod, from = "country", to = "cogscore")

# test if drinking behaviour has direct effect on cognitive score 
ci.test("drinking", "cogscore", 
        c("age", "female", "country", "education", "phyactivity", "depression"),
        data = w5_[rf_score], test = "mi")

# test if drinking behaviour has influence on obesity
ci.test("drinking", "obesity", c("female", "chronic", "smoking"),
        data = w5_[rf_score], test = "mi")
w5_.iamb.mod <- set.arc(w5_.iamb.mod, from = "drinking", to = "obesity")

# test if physical activity frequency has influence on obesity
ci.test("phyactivity", "obesity", 
        c("female", "smoking", "drinking", "chronic"),
        data = w5_[rf_score], test = "mi")
w5_.iamb.mod <- set.arc(w5_.iamb.mod, from = "phyactivity", to = "obesity")

#test if obesity has direct effect on cognitive score
ci.test("obesity", "cogscore", 
        c("age", "female", "country", "education", "phyactivity", "depression"),
        data = w5_[rf_score], test = "mi")

# test if obesity has influence on depression
ci.test("obesity", "depression", 
        c("female", "chronic", "economy", "social"),
        data = w5_[rf_score], test = "mi")
w5_.iamb.mod <- set.arc(w5_.iamb.mod, from = "obesity", to = "depression")

# test if age, gender or country has influence on smoking status
ci.test("smoking", "age", data = w5_[rf_score], test = "mi")
w5_.iamb.mod <- set.arc(w5_.iamb.mod, from = "age", to = "smoking")

# test if age or gender has influence on physical activity frequency
ci.test("age", "phyactivity", data = w5_[rf_score], test = "mi")
w5_.iamb.mod <- set.arc(w5_.iamb.mod, from = "age", to = "phyactivity")
```
```{r}
# display the network after modification above
graphviz.plot(w5_.iamb.mod)
```
```{r, warning = FALSE}
# compare the modified networks with initial ones using cv
dag.list <- list(w5_.hc, w5_.hc.mod, w5_.iamb, w5_.iamb.mod)
loss2 <- NULL
for (i in 1:length(dag.list)){
  set.seed(1)
  bn_cv <- bn.cv(w5_[rf_score], dag.list[[i]], 
                 loss = "pred", loss.args = list(target = "cogscore"))
  loss2[i] <- avg_loss(bn_cv)
}
names(loss2) <- c("hc", "hc.mod", "iamb", "iamb.mod")
sort(loss2, decreasing = FALSE)
```

```{r}
# final network - w5_.hc.mod
graphviz.plot(w5_.hc.mod)
```
```{r}
# use the final network to fit 
bn.bayes <- bn.fit(w5_.hc.mod, data = w5_[rf_score], 
                   method = "bayes", iss = 10000)
# display the factors having direct effect on cognitive score, i.e. parents
bn.bayes$cogscore$parents
```
```{r}
# levels of each direct factor
a.lv <- levels(w5_$age)    # age
f.lv <- levels(w5_$female)    # gender
c.lv <- levels(w5_$country)    # country
e.lv <- levels(w5_$education)    # education
d.lv <- levels(w5_$depression)    # depression 
cs.lv <- levels(w5_$cogscore)    # cognitive score
```


```{r, fig.width = 10}
# trend of cognitive score in different gender and country groups, 
# as age increases (holding education and depression at baseline level)
p1 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes$cogscore$prob[, , 1, 1, 1, 1]),
                                     ncol = 1),
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Male, Low aGDP (No Education, Low Depression)")
p2 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes$cogscore$prob[, , 1, 1, 1, 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Male, High aGDP (No Education, Low Depression)")
p3 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes$cogscore$prob[, , 2, 1, 1, 1]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Female, Low aGDP (No Education, Low Depression)")
p4 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes$cogscore$prob[, , 2, 1, 1, 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Female, High aGDP (No Education, Low Depression)")

grid.arrange(p1, p2, p3, p4, ncol = 2)
```
```{r}

olr.fitf <- polr(cogscore ~ age + education + depression + country,
                 data = w5_[w5_$female== 1, ])
olr.fitm <- polr(cogscore ~ age + education + depression + country,
                 data = w5_[w5_$female== 0, ])

combos <- data.frame(age = rep(a.lv, length(e.lv)), 
                     education = rep(e.lv, each = length(a.lv)),
                     depression = rep(d.lv, each = length(a.lv) * length(e.lv)),
                     country = rep(c.lv, each = length(a.lv) * 
                                        length(e.lv) * length(d.lv)))
distcsf <- predict(olr.fitf, newdata = combos ,type = "p")
distcsm <- predict(olr.fitm, newdata = combos ,type = "p")
distcs <- array(dim = c(length(cs.lv), length(a.lv), length(f.lv),
                        length(e.lv), length(d.lv), length(c.lv)), 
                dimnames = list(cogscore = cs.lv, age = a.lv, female = f.lv,
                                education = e.lv, depression = d.lv, 
                                country = c.lv))
distcs[ , , 1, , ,] <- array(t(distcsm), 
                             dim = c(length(cs.lv), length(a.lv), 1, 
                                     length(e.lv), length(d.lv),
                                     length(c.lv)))
distcs[ , , 2, , ,] <- array(t(distcsf), 
                             dim = c(length(cs.lv), length(a.lv), 1, 
                                     length(e.lv), length(d.lv),
                                     length(c.lv)))
bn.bayes2 <- bn.bayes
bn.bayes2$cogscore <- distcs
```

```{r, fig.width = 10}
p1 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, , 1, 1, 1, 1]),
                                     ncol = 1),
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Male, Low aGDP (No Education, Low Depression)")
p2 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, , 1, 1, 1, 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Male, High aGDP (No Education, Low Depression)")
p3 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, , 2, 1, 1, 1]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Female, Low aGDP (No Education, Low Depression)")
p4 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, , 2, 1, 1, 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Female, High aGDP (No Education, Low Depression)")

grid.arrange(p1, p2, p3, p4, ncol = 2)
```
```{r, fig.width = 10}
p1 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, , 1, 1, 2, 1]),
                                     ncol = 1),
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Male, Low aGDP (No Education, Medium Depression)")
p2 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, , 1, 1, 2, 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Male, High aGDP (No Education, Medium Depression)")
p3 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, , 2, 1, 2, 1]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Female, Low aGDP (No Education, Medium Depression)")
p4 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, , 2, 1, 2, 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Female, High aGDP (No Education, Medium Depression)")

grid.arrange(p1, p2, p3, p4, ncol = 2)
```

```{r, fig.width = 10}
p1 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, , 1, 1, 3, 1]),
                                     ncol = 1),
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Male, Low aGDP (No Education, High Depression)")
p2 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, , 1, 1, 3, 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Male, High aGDP (No Education, High Depression)")
p3 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, , 2, 1, 3, 1]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Female, Low aGDP (No Education, High Depression)")
p4 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, , 2, 1, 3, 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Female, High aGDP (No Education, High Depression)")

grid.arrange(p1, p2, p3, p4, ncol = 2)
```

```{r, fig.width = 10}
p1 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, , 1, 2, 1, 1]),
                                     ncol = 1),
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Male, Low aGDP (Primary Education, Low Depression)")
p2 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, , 1, 2, 1, 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Male, High aGDP (Primary Education, Low Depression)")
p3 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, , 2, 2, 1, 1]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Female, Low aGDP (Primary Education, Low Depression)")
p4 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, , 2, 2, 1, 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Female, High aGDP (Primary Education, Low Depression)")

grid.arrange(p1, p2, p3, p4, ncol = 2)
```

```{r, fig.width = 10}
p1 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, , 1, 2, 2, 1]),
                                     ncol = 1),
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Male, Low aGDP (Primary Education, Medium Depression)")
p2 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, , 1, 2, 2, 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Male, High aGDP (Primary Education, Medium Depression)")
p3 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, , 2, 2, 2, 1]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Female, Low aGDP (Primary Education, Medium Depression)")
p4 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, , 2, 2, 2, 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Female, High aGDP (Primary Education, Medium Depression)")

grid.arrange(p1, p2, p3, p4, ncol = 2)
```
```{r, fig.width = 10}
p1 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, , 1, 2, 3, 1]),
                                     ncol = 1),
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Male, Low aGDP (Primary Education, High Depression)")
p2 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, , 1, 2, 3, 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Male, High aGDP (Primary Education, High Depression)")
p3 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, , 2, 2, 3, 1]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Female, Low aGDP (Primary Education, High Depression)")
p4 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, , 2, 2, 3, 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Female, High aGDP (Primary Education, High Depression)")

grid.arrange(p1, p2, p3, p4, ncol = 2)
```

```{r, fig.width = 10}
p1 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, , 1, 3, 1, 1]),
                                     ncol = 1),
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Male, Low aGDP (Secondary Education, Low Depression)")
p2 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, , 1, 3, 1, 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Male, High aGDP (Secondary Education, Low Depression)")
p3 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, , 2, 3, 1, 1]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Female, Low aGDP (Secondary Education, Low Depression)")
p4 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, , 2, 3, 1, 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Female, High aGDP (Secondary Education, Low Depression)")

grid.arrange(p1, p2, p3, p4, ncol = 2)
```

```{r, fig.width = 10}
p1 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, , 1, 4, 3, 1]),
                                     ncol = 1),
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Male, Low aGDP (Post-Secondary Education, High Depression)")
p2 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, , 1, 4, 3, 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Male, High aGDP (Post-Secondary Education, High Depression)")
p3 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, , 2, 4, 3, 1]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Female, Low aGDP (Post-Secondary Education, High Depression)")
p4 <- ggplot(mapping = aes(x = rep(seq(1 : length(a.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, , 2, 4, 3, 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(a.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(a.lv)), labels = a.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Age", y = "Conditional probability", color = "Cognitive score", 
       title = "Female, High aGDP (Post-Secondary Education, High Depression)")

grid.arrange(p1, p2, p3, p4, ncol = 2)
```

```{r, fig.width = 10}
p1 <- ggplot(mapping = aes(x = rep(seq(1 : length(e.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 1, 1, , 1, 1]),
                                     ncol = 1),
                          color = rep(cs.lv, each = length(e.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(e.lv)), labels = e.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Education", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Male, Low aGDP (50-54, Low Depression)")
p2 <- ggplot(mapping = aes(x = rep(seq(1 : length(e.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 1, 1, , 1, 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(e.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(e.lv)), labels = e.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Education", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Male, High aGDP (50-54, Low Depression)")
p3 <- ggplot(mapping = aes(x = rep(seq(1 : length(e.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 1, 2, , 1, 1]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(e.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(e.lv)), labels = e.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Education", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Female, Low aGDP (50-54, Low Depression)")
p4 <- ggplot(mapping = aes(x = rep(seq(1 : length(e.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 1, 2, , 1, 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(e.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(e.lv)), labels = e.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Education", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Female, High aGDP (50-54, Low Depression)")

grid.arrange(p1, p2, p3, p4, ncol = 2)
```

```{r, fig.width = 10}
p1 <- ggplot(mapping = aes(x = rep(seq(1 : length(e.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 1, 1, , 2, 1]),
                                     ncol = 1),
                          color = rep(cs.lv, each = length(e.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(e.lv)), labels = e.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Education", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Male, Low aGDP (50-54, Medium Depression)")
p2 <- ggplot(mapping = aes(x = rep(seq(1 : length(e.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 1, 1, , 2, 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(e.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(e.lv)), labels = e.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Education", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Male, High aGDP (50-54, Medium Depression)")
p3 <- ggplot(mapping = aes(x = rep(seq(1 : length(e.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 1, 2, , 2, 1]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(e.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(e.lv)), labels = e.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Education", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Female, Low aGDP (50-54, MEdium Depression)")
p4 <- ggplot(mapping = aes(x = rep(seq(1 : length(e.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 1, 2, , 2, 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(e.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(e.lv)), labels = e.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Education", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Female, High aGDP (50-54, Medium Depression)")

grid.arrange(p1, p2, p3, p4, ncol = 2)
```

```{r, fig.width = 10}
p1 <- ggplot(mapping = aes(x = rep(seq(1 : length(e.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 1, 1, , 3, 1]),
                                     ncol = 1),
                          color = rep(cs.lv, each = length(e.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(e.lv)), labels = e.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Education", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Male, Low aGDP (50-54, High Depression)")
p2 <- ggplot(mapping = aes(x = rep(seq(1 : length(e.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 1, 1, , 3, 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(e.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(e.lv)), labels = e.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Education", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Male, High aGDP (50-54, High Depression)")
p3 <- ggplot(mapping = aes(x = rep(seq(1 : length(e.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 1, 2, , 3, 1]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(e.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(e.lv)), labels = e.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Education", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Female, Low aGDP (50-54, High Depression)")
p4 <- ggplot(mapping = aes(x = rep(seq(1 : length(e.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 1, 2, , 3, 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(e.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(e.lv)), labels = e.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Education", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Female, High aGDP (50-54, High Depression)")

grid.arrange(p1, p2, p3, p4, ncol = 2)
```

```{r, fig.width = 10}
p1 <- ggplot(mapping = aes(x = rep(seq(1 : length(e.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 8, 1, , 1, 1]),
                                     ncol = 1),
                          color = rep(cs.lv, each = length(e.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(e.lv)), labels = e.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Education", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Male, Low aGDP (>=85, Low Depression)")
p2 <- ggplot(mapping = aes(x = rep(seq(1 : length(e.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 8, 1, , 1, 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(e.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(e.lv)), labels = e.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Education", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Male, High aGDP (>=85, Low Depression)")
p3 <- ggplot(mapping = aes(x = rep(seq(1 : length(e.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 8, 2, , 1, 1]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(e.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(e.lv)), labels = e.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Education", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Female, Low aGDP (>=85, Low Depression)")
p4 <- ggplot(mapping = aes(x = rep(seq(1 : length(e.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 8, 2, , 1, 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(e.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(e.lv)), labels = e.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Education", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Female, High aGDP (>=85, Low Depression)")

grid.arrange(p1, p2, p3, p4, ncol = 2)
```

```{r, fig.width = 10}
p1 <- ggplot(mapping = aes(x = rep(seq(1 : length(e.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 8, 1, , 2, 1]),
                                     ncol = 1),
                          color = rep(cs.lv, each = length(e.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(e.lv)), labels = e.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Education", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Male, Low aGDP (>=85, Medium Depression)")
p2 <- ggplot(mapping = aes(x = rep(seq(1 : length(e.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 8, 1, , 2, 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(e.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(e.lv)), labels = e.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Education", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Male, High aGDP (>=85, Medium Depression)")
p3 <- ggplot(mapping = aes(x = rep(seq(1 : length(e.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 8, 2, , 2, 1]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(e.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(e.lv)), labels = e.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Education", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Female, Low aGDP (>=85, MEdium Depression)")
p4 <- ggplot(mapping = aes(x = rep(seq(1 : length(e.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 8, 2, , 2, 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(e.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(e.lv)), labels = e.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Education", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Female, High aGDP (>=85, Medium Depression)")

grid.arrange(p1, p2, p3, p4, ncol = 2)
```

```{r, fig.width = 10}
p1 <- ggplot(mapping = aes(x = rep(seq(1 : length(e.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 8, 1, , 3, 1]),
                                     ncol = 1),
                          color = rep(cs.lv, each = length(e.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(e.lv)), labels = e.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Education", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Male, Low aGDP (>=85, High Depression)")
p2 <- ggplot(mapping = aes(x = rep(seq(1 : length(e.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 8, 1, , 3, 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(e.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(e.lv)), labels = e.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Education", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Male, High aGDP (>=85, High Depression)")
p3 <- ggplot(mapping = aes(x = rep(seq(1 : length(e.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 8, 2, , 3, 1]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(e.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(e.lv)), labels = e.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Education", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Female, Low aGDP (>=85, High Depression)")
p4 <- ggplot(mapping = aes(x = rep(seq(1 : length(e.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 8, 2, , 3, 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(e.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(e.lv)), labels = e.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Education", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Female, High aGDP (>=85, High Depression)")

grid.arrange(p1, p2, p3, p4, ncol = 2)
```

```{r, fig.width = 10}
p1 <- ggplot(mapping = aes(x = rep(seq(1 : length(d.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 1, 1, 1, , 1]),
                                     ncol = 1),
                          color = rep(cs.lv, each = length(d.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(d.lv)), labels = d.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Depression", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Male, Low aGDP (50-54, No Education)")
p2 <- ggplot(mapping = aes(x = rep(seq(1 : length(d.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 1, 1, 1, , 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(d.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(d.lv)), labels = d.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Depression", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Male, High aGDP (50-54, No Education)")
p3 <- ggplot(mapping = aes(x = rep(seq(1 : length(d.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 1, 2, 1, , 1]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(d.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(d.lv)), labels = d.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Depression", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Female, Low aGDP (50-54, No Education)")
p4 <- ggplot(mapping = aes(x = rep(seq(1 : length(d.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 1, 2, 1, , 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(d.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(d.lv)), labels = d.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Depression", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Female, High aGDP (50-54, No Education)")

grid.arrange(p1, p2, p3, p4, ncol = 2)
```

```{r, fig.width = 10}
p1 <- ggplot(mapping = aes(x = rep(seq(1 : length(d.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 1, 1, 2, , 1]),
                                     ncol = 1),
                          color = rep(cs.lv, each = length(d.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(d.lv)), labels = d.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Depression", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Male, Low aGDP (50-54, Primary Education)")
p2 <- ggplot(mapping = aes(x = rep(seq(1 : length(d.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 1, 1, 2, , 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(d.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(d.lv)), labels = d.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Depression", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Male, High aGDP (50-54, Primary Education)")
p3 <- ggplot(mapping = aes(x = rep(seq(1 : length(d.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 1, 2, 2, , 1]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(d.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(d.lv)), labels = d.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Depression", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Female, Low aGDP (50-54, Primary Education)")
p4 <- ggplot(mapping = aes(x = rep(seq(1 : length(d.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 1, 2, 2, , 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(d.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(d.lv)), labels = d.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Depression", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Female, High aGDP (50-54, Primary Education)")

grid.arrange(p1, p2, p3, p4, ncol = 2)
```

```{r, fig.width = 10}
p1 <- ggplot(mapping = aes(x = rep(seq(1 : length(d.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 1, 1, 5, , 1]),
                                     ncol = 1),
                          color = rep(cs.lv, each = length(d.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(d.lv)), labels = d.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Depression", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Male, Low aGDP (50-54, Post-Secondary Education)")
p2 <- ggplot(mapping = aes(x = rep(seq(1 : length(d.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 1, 1, 5, , 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(d.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(d.lv)), labels = d.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Depression", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Male, High aGDP (50-54, Post-Secondary Education)")
p3 <- ggplot(mapping = aes(x = rep(seq(1 : length(d.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 1, 2, 5, , 1]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(d.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(d.lv)), labels = d.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Depression", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Female, Low aGDP (50-54, Post-Secondary Education)")
p4 <- ggplot(mapping = aes(x = rep(seq(1 : length(d.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 1, 2, 5, , 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(d.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(d.lv)), labels = d.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Depression", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Female, High aGDP (50-54, Post-Secondary Education)")

grid.arrange(p1, p2, p3, p4, ncol = 2)
```

```{r, fig.width = 10}
p1 <- ggplot(mapping = aes(x = rep(seq(1 : length(d.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 8, 1, 1, , 1]),
                                     ncol = 1),
                          color = rep(cs.lv, each = length(d.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(d.lv)), labels = d.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Depression", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Male, Low aGDP (>=85, No Education)")
p2 <- ggplot(mapping = aes(x = rep(seq(1 : length(d.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 8, 1, 1, , 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(d.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(d.lv)), labels = d.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Depression", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Male, High aGDP (>=85, No Education)")
p3 <- ggplot(mapping = aes(x = rep(seq(1 : length(d.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 8, 2, 1, , 1]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(d.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(d.lv)), labels = d.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Depression", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Female, Low aGDP (>=85, No Education)")
p4 <- ggplot(mapping = aes(x = rep(seq(1 : length(d.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 8, 2, 1, , 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(d.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(d.lv)), labels = d.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Depression", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Female, High aGDP (>=85, No Education)")

grid.arrange(p1, p2, p3, p4, ncol = 2)
```

```{r, fig.width = 10}
p1 <- ggplot(mapping = aes(x = rep(seq(1 : length(d.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 8, 1, 5, , 1]),
                                     ncol = 1),
                          color = rep(cs.lv, each = length(d.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(d.lv)), labels = d.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Depression", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Male, Low aGDP (>=85, Post-Secondary Education)")
p2 <- ggplot(mapping = aes(x = rep(seq(1 : length(d.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 8, 1, 5, , 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(d.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(d.lv)), labels = d.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Depression", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Male, High aGDP (>=85, Post-Secondary Education)")
p3 <- ggplot(mapping = aes(x = rep(seq(1 : length(d.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 8, 2, 5, , 1]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(d.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(d.lv)), labels = d.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Depression", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Female, Low aGDP (>=85, Post-Secondary Education)")
p4 <- ggplot(mapping = aes(x = rep(seq(1 : length(d.lv)), 3),
                          y = matrix(t(bn.bayes2$cogscore$prob[, 8, 2, 5, , 2]),
                                     ncol = 1), 
                          color = rep(cs.lv, each = length(d.lv)))) + 
  geom_point() +
  geom_line() +
  scale_x_discrete(breaks = seq(1 : length(d.lv)), labels = d.lv) +
  theme(plot.title = element_text(size = 12)) + 
  labs(x = "Depression", y = "Conditional probability", 
       color = "Cognitive score", 
       title = "Female, High aGDP (>=85, Post-Secondary Education)")

grid.arrange(p1, p2, p3, p4, ncol = 2)
```